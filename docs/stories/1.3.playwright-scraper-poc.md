# Story 1.3: Playwright Scraper POC for Single Telco Source

## Status
Draft

## Story
**As a** developer,
**I want** to build a proof-of-concept scraper for one telco website using Playwright,
**so that** I can validate the scraping approach works for JavaScript-heavy sites.

## Acceptance Criteria

1. Playwright installed and configured for headless browser execution (webkit or chromium)
2. Scraper script targets one telco website (recommend O2 or Sky as proven working examples)
3. Script successfully loads target page and waits for dynamic content to render
4. Handles cookie consent modal if present (click accept)
5. Extracts at least 3 SIM-only plan data points: pricing, data allowance, contract term
6. Handles common errors (timeout, element not found) with retry logic
7. Outputs scraped data to console as JSON or structured array
8. Script executable via `npm run scrape:poc` command
9. Basic documentation of selectors and scraping logic

## Tasks / Subtasks

- [ ] Install Playwright (AC: 1)
  - [ ] Install `playwright` package
  - [ ] Install browser binaries (webkit or chromium)
  - [ ] Configure for headless execution
- [ ] Create POC scraper script (AC: 2)
  - [ ] Choose target telco (O2 or Sky recommended)
  - [ ] Create `src/lib/scraping/collectors/{telco}.ts`
  - [ ] Set up basic Playwright page navigation
- [ ] Implement page loading and waiting (AC: 3)
  - [ ] Navigate to target URL
  - [ ] Wait for dynamic content to render
  - [ ] Wait for plan elements to be visible
- [ ] Handle cookie consent (AC: 4)
  - [ ] Detect cookie consent modal
  - [ ] Click accept button (site-specific selector)
  - [ ] Wait for modal to close
- [ ] Extract plan data (AC: 5)
  - [ ] Extract pricing information
  - [ ] Extract data allowance
  - [ ] Extract contract term
  - [ ] Structure data as JSON/array
- [ ] Implement error handling (AC: 6)
  - [ ] Add retry logic for failed scrapes
  - [ ] Handle timeout errors
  - [ ] Handle element not found errors
  - [ ] Add error logging
- [ ] Output scraped data (AC: 7)
  - [ ] Format as JSON or structured array
  - [ ] Output to console
  - [ ] Verify output format
- [ ] Create npm script (AC: 8)
  - [ ] Add `scrape:poc` script to `package.json`
  - [ ] Test script execution
- [ ] Document scraper (AC: 9)
  - [ ] Document selectors used
  - [ ] Document scraping logic
  - [ ] Document any assumptions or limitations

## Dev Notes

### Source Tree
- Scraper location: `src/lib/scraping/collectors/{telco}.ts` (e.g., `o2.ts` or `sky.ts`)
- Main scraping entry point: `src/scripts/scrape.ts` (for future use)
- Playwright uses headless browser execution (webkit or chromium)

### Technical Stack
- Playwright for browser automation
- Headless browser execution
- Site-specific selectors for cookie consent and plan data

### Testing
- Test file location: `tests/integration/scraping/{telco}.test.ts` (to be created)
- Test framework: Jest with mocked Playwright
- Mock network requests to avoid hitting real sites in tests
- Test error handling and retry logic

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-XX | 1.0 | Story extracted from PRD | Architect |

## Dev Agent Record

### Agent Model Used
_To be populated by Dev Agent_

### Debug Log References
_To be populated by Dev Agent_

### Completion Notes List
_To be populated by Dev Agent_

### File List
_To be populated by Dev Agent_

## QA Results
_To be populated by QA Agent_

